{% extends "base.html" %}
{% block content %}
<section class="page-head">
  <div>
    <h1>Prompt 收录</h1>
    <p class="muted">集中管理你的提示词卡片，随时复制复用。</p>
  </div>
  <a class="primary" href="/prompts/new">创建新卡片</a>
</section>

<section class="panel filter-panel">
  <form class="filter-form" method="get" action="/">
    <div class="field">
      <label for="sort">排序方式</label>
      <select id="sort" name="sort" data-auto-submit>
        <option value="updated_desc" {% if selected_sort == "updated_desc" %}selected{% endif %}>按最新更新时间</option>
        <option value="created_desc" {% if selected_sort == "created_desc" %}selected{% endif %}>按创建时间</option>
      </select>
    </div>
    <div class="field">
      <label for="tag_id">标签筛选</label>
      <select id="tag_id" name="tag_id" data-auto-submit>
        <option value="">全部标签</option>
        {% for tag in tags %}
          <option value="{{ tag.id }}" {% if selected_tag_id is not none and selected_tag_id == tag.id %}selected{% endif %}>
            {{ tag.name }}
          </option>
        {% endfor %}
      </select>
    </div>
  </form>
</section>

<section class="cards">
  {% if prompts %}
    {% for prompt, tags in prompts %}
      <article class="card" data-href="/prompts/{{ prompt.id }}">
        <div class="card-head">
          <h3>{{ prompt.title }}</h3>
          <button class="ghost" type="button" data-copy="{{ prompt.content | e }}">复制</button>
        </div>
        <p class="summary">{{ prompt.summary }}</p>
        <div class="tag-row">
          {% for tag in tags %}
            <span class="tag" style="--tag-color: {{ tag.color }}">{{ tag.name }}</span>
          {% endfor %}
        </div>
        <p class="card-meta">创建于 {{ prompt.created_at.split("T")[0] }} · 更新于 {{ prompt.updated_at.split("T")[0] }}</p>
      </article>
    {% endfor %}
  {% else %}
    <div class="empty">
      <p>还没有 Prompt 卡片，马上创建一个吧。</p>
      <a class="primary" href="/prompts/new">创建新卡片</a>
    </div>
  {% endif %}
</section>
{% endblock %}
